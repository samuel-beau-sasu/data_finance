-- definitions/marts/test_minimal.sqlx

js {
  const test_var = ["test1", "test2"];
  
  // Option 1: CrÃ©er une seule vue avec UNION ALL
  publish("test_minimal", {
    type: "view",
    schema: "bq_data_finance_prod",
    description: "Test minimal avec valeurs multiples"
  }).query(ctx => `
    ${test_var.map(item => `SELECT '${item}' AS value`).join('\nUNION ALL\n')}
  `);
}